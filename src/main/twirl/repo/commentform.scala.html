@(commitId: String,
  fileName: Option[String] = None,
  oldLineNumber: Option[Int] = None,
  newLineNumber: Option[Int] = None,
  hasWritePermission: Boolean,
  repository: service.RepositoryService.RepositoryInfo)(implicit context: app.Context)
@import context._
@import view.helpers._
@if(loginAccount.isDefined){
  @if(!fileName.isDefined){<hr/><br/>}
  <form method="POST" validate="true">
    @if(!fileName.isDefined){
      <div class="issue-avatar-image">@avatar(loginAccount.get.userName, 48)</div>
    }
    <div class="box issue-comment-box">
      <div class="box-content">
        @helper.html.preview(repository, "", false, true, true, hasWritePermission, "width: 635px; height: 100px; max-height: 150px;", elastic = true)
      </div>
      @if(fileName.isDefined){
        <div class="pull-right" style="margin-top: 10px;">
          <input type="button" class="btn btn-default" value="Cancel"/>
          <input type="submit" class="btn btn-success" formaction="@url(repository)/commit/@commitId/comment/new" value="Comment"/>
        </div>
      }
    </div>
    @if(!fileName.isDefined){
      <div class="pull-right">
        <input type="submit" class="btn btn-success" formaction="@url(repository)/commit/@commitId/comment/new" value="Comment on this commit"/>
      </div>
    }
    @if(fileName.isDefined){<input type="hidden" name="fileName" value="@fileName.get">}
    @if(oldLineNumber.isDefined){<input type="hidden" name="oldLineNumber" value="@oldLineNumber.get">}
    @if(newLineNumber.isDefined){<input type="hidden" name="newLineNumber" value="@newLineNumber.get">}
  </form>
}
